<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INBDE Practice Exam</title>
    <style>
        /* --- Estilos Generales --- */
        :root {
            --primary-color: #005f73;
            --primary-dark: #003049;
            --light-bg: #f4f7f6;
            --white: #ffffff;
            --border-color: #dee2e6;
            --correct-bg: #e6fcf5;
            --correct-border: #b7e9d7;
            --incorrect-bg: #fff5f5;
            --incorrect-border: #ffd6d6;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--light-bg);
            color: #333;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }

        /* --- Contenedor Principal --- */
        .quiz-container {
            max-width: 800px;
            margin: 20px auto;
            background: var(--white);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            overflow: hidden;
        }
        
        /* --- Encabezado --- */
        header {
            padding: 20px 30px;
            background-color: var(--primary-color);
            color: var(--white);
            border-bottom: 1px solid var(--primary-dark);
        }
        header h1 {
            margin: 0;
            font-size: 1.6em;
        }
        #progressText {
            margin: 5px 0 0;
            font-size: 1em;
            opacity: 0.9;
            font-weight: 600;
        }

        /* --- Cuerpo del Quiz --- */
        #quizBody {
            padding: 30px;
        }
        .question-title {
            font-weight: 600;
            font-size: 1.15em;
            margin-bottom: 20px;
            color: var(--primary-dark);
        }
        
        /* --- Opciones (Radio Buttons) --- */
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        .options label {
            display: block;
            padding: 12px 15px;
            background-color: #f8f9fa;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }
        .options label:hover {
            background-color: #e9ecef;
        }
        .options input[type="radio"] {
            /* Ocultos pero accesibles */
            opacity: 0;
            width: 0;
            height: 0;
            position: absolute;
        }
        .options label span {
            display: inline-block;
            margin-left: 5px;
        }
        /* Estilo para la opción seleccionada */
        .options label:has(input[type="radio"]:checked) {
            border-color: var(--primary-color);
            background-color: #e6f7ff;
            box-shadow: 0 0 0 2px rgba(0, 95, 115, 0.2);
        }

        /* --- Footer y Botón --- */
        .quiz-footer {
            padding: 20px 30px;
            background-color: #fdfdfd;
            border-top: 1px solid #f0f0f0;
            text-align: right;
        }
        #nextBtn {
            display: inline-block; /* Cambiado de 'block' */
            padding: 12px 30px;
            font-size: 1.1em;
            font-weight: 600;
            color: white;
            background-color: #0077b6;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }
        #nextBtn:hover {
            background-color: #005a8d;
        }

        /* --- Sección de Resultados --- */
        #resultsPage {
            padding: 10px;
        }
        .score-summary {
            text-align: center;
            padding: 30px;
            background: var(--primary-dark);
            color: var(--white);
        }
        .score-summary h2 {
            margin: 0;
            font-size: 2.5em;
        }
        .result-item {
            border-bottom: 1px solid var(--border-color);
            padding: 20px;
        }
        .result-item .question-title {
            font-size: 1.1em;
            color: #333;
        }
        .result-item p {
            margin: 5px 0;
        }
        .explanation {
            background: #f8f9fa;
            border-left: 4px solid #0077b6;
            padding: 10px 15px;
            margin-top: 15px;
            font-size: 0.95em;
        }
        /* Estilos para Correcto/Incorrecto */
        .result-item.correct {
            background-color: var(--correct-bg);
            border-left: 5px solid #2a9d8f;
        }
        .result-item.incorrect {
            background-color: var(--incorrect-bg);
            border-left: 5px solid #e76f51;
        }
        .result-item h3 {
            margin: 0 0 10px;
            font-size: 1.2em;
        }
        .result-item.correct h3 {
            color: #2a9d8f;
        }
        .result-item.incorrect h3 {
            color: #e76f51;
        }
        .answer-key {
            font-weight: 600;
        }

        .hidden {
            display: none;
        }
        
        /* --- Estilos Responsivos (Móvil) --- */
        @media (max-width: 600px) {
            body {
                background-color: var(--white);
            }
            .quiz-container {
                margin: 0;
                border-radius: 0;
                box-shadow: none;
                width: 100%;
            }
            header {
                padding: 20px;
                border-radius: 0;
            }
            header h1 {
                font-size: 1.4em;
            }
            #quizBody, .quiz-footer {
                padding: 20px;
            }
            #resultsPage {
                padding: 0;
            }
            .result-item {
                padding: 15px;
            }
        }
    </style>
</head>
<body>

    <div class="quiz-container">
        <header>
            <h1>INBDE Practice Exam</h1>
            <p id="progressText">Cargando...</p>
        </header>
        
        <div id="quizBody"></div>

        <div class="quiz-footer">
            <button id="nextBtn">Siguiente</button>
        </div>

        <div id="resultsPage" class="hidden">
            </div>

    </div>

    <script>
        // --- Fuente de Datos: Preguntas, Opciones y Explicaciones ---
        const quizData = [
            {
                question: "A 68-year-old male with end-stage renal disease (ESRD) presents for emergency extraction of tooth #30. His nephrologist confirms a GFR of 8 mL/min. Which analgesic and antibiotic regimen, if prescribed without modification, poses the LEAST iatrogenic risk?",
                options: [
                    { text: "Ibuprofen 800mg and Tetracycline 500mg", value: "a" },
                    { text: "Acetaminophen 500mg and Amoxicillin 500mg", value: "b" },
                    { text: "Diclofenac 50mg and Metronidazole 500mg", value: "c" },
                    { text: "Naproxen 500mg and Acyclovir 400mg", value: "d" },
                    { text: "Codeine 30mg and Doxycycline 100mg", value: "e" }
                ],
                correct: "e",
                explanation: "Con un GFR < 10 mL/min, se deben evitar los AINEs (Ibuprofen, Diclofenac, Naproxen) por ser nefrotóxicos. También se deben evitar antibióticos de eliminación renal como Amoxicilina, Tetraciclina y Aciclovir. Doxycycline se elimina principalmente por vía hepática y la Codeína se considera segura, siendo esta la opción de menor riesgo."
            },
            {
                question: "A patient with chronic renal failure awaiting transplantation presents for a consultation. Clinical examination reveals pale mucosa, gingival petechiae, and significant lingual erosion. Radiographs show decreased trabeculation and partial pulp obliteration. Which of the following findings would be INCONSISTENT with the patient's systemic condition?",
                options: [
                    { text: "Uremic stomatitis with painful hyperkeratotic lesions.", value: "a" },
                    { text: "A high prevalence of rampant smooth-surface caries.", value: "b" },
                    { text: "Gingival hyperplasia secondary to immunosuppressive therapy.", value: "c" },
                    { text: "Xerostomia attributed to polypharmacy and fluid restriction.", value: "d" },
                    { text: "Soft tissue radiolucencies consistent with renal osteodystrophy.", value: "e" }
                ],
                correct: "b",
                explanation: "La uremia tiene un efecto bacteriostático y buffer (por la urea en la saliva), lo que paradójicamente DISMINUYE el riesgo de caries en pacientes con insuficiencia renal. Todos los demás hallazgos (estomatitis, hiperplasia por ciclosporina, xerostomía y osteodistrofia renal) son manifestaciones orales clásicas."
            },
            {
                question: "A dental patient's medical history update reveals a recent blood creatinine level of 4.5 mg/dl. Based on the provided staging, what is the most probable clinical status and corresponding creatinine clearance range for this individual?",
                options: [
                    { text: "Normal function; 90-120 mL/min", value: "a" },
                    { text: "Renal compensation; >45-60 mL/min", value: "b" },
                    { text: "Onset of clinical features; 20-60 mL/min", value: "c" },
                    { text: "Established clinical disease; 10-25 mL/min", value: "d" },
                    { text: "Dialysis required; <10 mL/min", value: "e" }
                ],
                correct: "d",
                explanation: "Según la tabla del documento, un nivel de creatinina en sangre entre 2.5-10 mg/dl corresponde a 'Established clinical disease' (Enfermedad clínica establecida), que tiene un aclaramiento de creatinina de 10-25 mL/min. 4.5 mg/dl se encuentra dentro de este rango."
            },
            {
                question: "A patient who received a renal transplant 7 years prior is on a stable regimen of cyclosporine and prednisone. Which of the following oral findings is LEAST likely to be directly associated with the patient's post-transplant medical management?",
                options: [
                    { text: "Gingival hyperplasia", value: "a" },
                    { text: "Oral hairy leukoplakia", value: "b" },
                    { text: "Kaposi's sarcoma", value: "c" },
                    { text: "Enamel hypoplasia", value: "d" },
                    { text: "Candidiasis", value: "e" }
                ],
                correct: "d",
                explanation: "La hipoplasia del esmalte es un defecto del desarrollo que ocurre mientras se forma el diente. No puede ser causada por medicamentos en un adulto post-trasplante. La hiperplasia (por ciclosporina) y las infecciones oportunistas (leucoplasia vellosa, sarcoma, candidiasis) son riesgos conocidos de la inmunosupresión."
            },
            {
                question: "A clinician is managing a hospitalized patient for a DVT. The patient was initially started on an IV anticoagulant that monitors the intrinsic pathway and has a rapid onset. The plan is to transition to an oral anticoagulant that is teratogenic and monitored via the extrinsic pathway. Which drug combination represents this transition?",
                options: [
                    { text: "Initial: Warfarin; Transition: Heparin", value: "a" },
                    { text: "Initial: Heparin; Transition: Warfarin", value: "b" },
                    { text: "Initial: Clopidogrel; Transition: Dabigatran", value: "c" },
                    { text: "Initial: Rivaroxaban; Transition: Apixaban", value: "d" },
                    { text: "Initial: Protamine; Transition: Vitamin K", value: "e" }
                ],
                correct: "b",
                explanation: "La Heparina es IV, de inicio rápido y afecta la vía intrínseca (se monitoriza con aPTT). La Warfarina es oral, de inicio lento, teratogénica y afecta la vía extrínseca (se monitoriza con PT/INR). Esta es la 'terapia puente' clásica."
            },
            {
                question: "A 55-year-old patient on chronic warfarin therapy for atrial fibrillation requires extraction of tooth #14. His INR, measured 24 hours prior, is 2.7. Which of the following constitutes the LEAST appropriate management strategy according to current ADA and AAOM recommendations?",
                options: [
                    { text: "Proceeding with the extraction using local hemostatic measures.", value: "a" },
                    { text: "Instructing the patient to discontinue warfarin 3 days prior to the procedure.", value: "b" },
                    { text: "Prescribing acetaminophen for post-operative pain control.", value: "c" },
                    { text: "Administering local anesthetic with a vasoconstrictor via infiltration.", value: "d" },
                    { text: "Consulting the patient's physician, but not altering the warfarin dose.", value: "e" }
                ],
                correct: "b",
                explanation: "Un INR de 2.7 está dentro del rango terapéutico (2.0-3.5) para procedimientos dentales. Las guías de la ADA y AAOM indican explícitamente NO suspender la warfarina, ya que el riesgo de un evento tromboembólico (ej. ACV) supera el riesgo de sangrado dental, el cual puede ser controlado con medidas locales."
            },
            {
                question: "A patient with a stable therapeutic INR of 2.5 on warfarin is diagnosed with a dental abscess. The dentist prescribes an antibiotic and the patient self-medicates. One week later, the patient's INR is dangerously elevated to 5.2. Which combination of medications FAILS to explain this potentiation?",
                options: [
                    { text: "Erythromycin and acute ethanol consumption.", value: "a" },
                    { text: "Ciprofloxacin and omeprazole.", value: "b" },
                    { text: "Metronidazole and acetaminophen.", value: "c" },
                    { text: "Sulphonamides and disulfiram.", value: "d" },
                    { text: "Rifampicin and chronic ethanol consumption.", value: "e" }
                ],
                correct: "e",
                explanation: "La pregunta busca la combinación que NO aumenta (potencia) el INR. La Rifampicina (y el alcoholismo crónico) es un potente inductor de las enzimas P450 (CRAP BARS). Esto acelera el metabolismo de la warfarina, DISMINUYENDO su efecto y bajando el INR. Las otras opciones son inhibidores enzimáticos que elevan el INR."
            },
            {
                question: "A patient taking Apixaban (Eliquis) for DVT prevention requires a single-tooth implant placement. Which of the following management plans is most consistent with the provided guidelines for direct-acting oral anticoagulants (DOACs)?",
                options: [
                    { text: "Discontinue Apixaban 5 days prior to surgery.", value: "a" },
                    { text: "Bridge the patient with low molecular weight heparin.", value: "b" },
                    { text: "Proceed with the implant positioning without altering the Apixaban regimen.", value: "c" },
                    { text: "Admit the patient for surgery and have Vitamin K on standby.", value: "d" },
                    { text: "Double the Apixaban dose 24 hours post-operatively to compensate.", value: "e" }
                ],
                correct: "c",
                explanation: "Para procedimientos dentales de bajo riesgo (como la colocación de 1-3 implantes o extracciones), las guías indican que los DOACs (como Apixaban) no requieren ser suspendidos ni modificados, siempre y cuando se usen medidas hemostáticas locales."
            },
            {
                question: "A patient presents with a non-healing extraction socket 10 weeks post-operatively. The patient has a history of IV Zoledronic acid for bone metastases. A panoramic radiograph confirms exposed, necrotic bone. Which additional finding is REQUIRED to confirm a diagnosis of MRONJ?",
                options: [
                    { text: "A history of concurrent chemotherapy.", value: "a" },
                    { text: "Evidence of infection or fistula.", value: "b" },
                    { text: "An absence of radiation therapy to the maxillofacial region.", value: "c" },
                    { text: "Exposure to an oral bisphosphonate for less than 4 years.", value: "d" },
                    { text: "A pathologic fracture of the inferior border.", value: "e" }
                ],
                correct: "c",
                explanation: "La definición de MRONJ (según AAOMS 2022) tiene 3 criterios: 1) Uso de antirresortivos, 2) Hueso expuesto por >8 semanas, y 3) Ausencia de historia de radioterapia en la región. Si hubiera radioterapia, el diagnóstico diferencial sería osteorradionecrosis (ORN)."
            },
            {
                question: "A patient on oral Alendronate for 6 years presents with dull, aching pain in the right mandible and loosening of tooth #29, not explained by periodontal disease. There is no visible exposed bone or fistula. Radiographs show localized osteosclerosis and obscuring of the PDL space. This clinical presentation is most consistent with:",
                options: [
                    { text: "MRONJ Stage 1", value: "a" },
                    { text: "MRONJ Stage 2", value: "b" },
                    { text: "MRONJ Stage 0 (Nonexposed bone variant)", value: "c" },
                    { text: "MRONJ Stage 3", value: "d" },
                    { text: "Osteoradionecrosis", value: "e" }
                ],
                correct: "c",
                explanation: "La AAOMS define el Estadio 0 de MRONJ como la presencia de síntomas (dolor, movilidad dental) y cambios radiográficos (esclerosis, ensanchamiento del PDL) consistentes con MRONJ, pero SIN la presencia de hueso expuesto o fístula."
            },
            {
                question: "A patient is diagnosed with MRONJ Stage 2. According to the non-operative treatment flowchart, which therapeutic modality is introduced at this stage that is NOT indicated for Stage 1?",
                options: [
                    { text: "Removal of mobile sequestrum.", value: "a" },
                    { text: "Local wound care to exposed bone.", value: "b" },
                    { text: "Segmental resection of the mandible.", value: "c" },
                    { text: "Systemic antibiotics and pain control.", value: "d" },
                    { text: "Antimicrobial rinses.", value: "e" }
                ],
                correct: "d",
                explanation: "El Estadio 1 se define como hueso expuesto asintomático y sin infección. El Estadio 2 es hueso expuesto CON infección y/o dolor. Por lo tanto, el manejo del Estadio 2 añade antibióticos sistémicos y control del dolor, lo cual no está indicado en el Estadio 1."
            },
            {
                question: "A 72-year-old female is scheduled for multiple extractions. Her medical history is significant for osteoporosis, for which she received an IV infusion of Zoledronic acid (Reclast) 11 months ago. Which statement INACCURATELY reflects the 2022 AAOMS guidelines regarding her management?",
                options: [
                    { text: "A drug holiday is not indicated as she is taking the drug for osteoporosis, not cancer.", value: "a" },
                    { text: "The patient is at risk for MRONJ.", value: "b" },
                    { text: "The benefit of a drug holiday for patients receiving antiresorptive therapy for cancer is unsubstantiated.", value: "c" },
                    { text: "If the patient were on Denosumab, surgery would be timed 3-4 months after the last dose.", value: "d" },
                    { text: "If she had been on oral Alendronate for >4 years, a 3-4 month holiday prior to surgery would be considered.", value: "e" }
                ],
                correct: "a",
                explanation: "Esta afirmación es la más incorrecta. Aunque el riesgo es menor que en pacientes con cáncer, los pacientes con osteoporosis que reciben antirresortivos (especialmente IV, como Reclast) SÍ tienen riesgo. Las guías consideran el tiempo desde la última dosis y no descartan un 'drug holiday' o, más bien, programar la cirugía antes de la siguiente dosis."
            },
            {
                question: "A patient receiving bolus-dose 5-Fluorouracil chemotherapy presents with severe, painful oral ulcerations 5 days after their first infusion. Which of the following statements regarding their condition is LEAST accurate?",
                options: [
                    { text: "The condition is termed oral mucositis and is characterized by epithelial disruption.", value: "a" },
                    { text: "The lesions are expected to resolve 2-4 weeks after the completion of the entire chemotherapy course.", value: "b" },
                    { text: "The chemotherapeutic agent, 5-Fluorouracil, is known to be highly associated with this reaction.", value: "c" },
                    { text: "Palliative management includes vigorous use of chlorhexidine or alcohol-based mouthrinses.", value: "d" },
                    { text: "Prophylactic use of oral cryotherapy during the infusion may reduce the severity of this condition.", value: "e" }
                ],
                correct: "d",
                explanation: "Esta afirmación es falsa. Los enjuagues con alcohol o Clorhexidina (que a menudo tiene alcohol) son citotóxicos e irritantes para la mucosa ulcerada de la mucositis. El manejo paliativo se centra en enjuagues blandos, como solución salina o bicarbonato de sodio."
            },
            {
                question: "A patient undergoing chemotherapy presents for an emergency dental visit. Which of the following clinical findings is NOT a recognized direct or indirect sequela of their antineoplastic therapy?",
                options: [
                    { text: "Oral candidiasis secondary to neutropenia.", value: "a" },
                    { text: "Herpetic lesions secondary to immunosuppression.", value: "b" },
                    { text: "Bilateral, reticular, white striae on the buccal mucosa consistent with a lichenoid reaction.", value: "c" },
                    { text: "Spontaneous gingival bleeding secondary to thrombocytopenia.", value: "d" },
                    { text: "Accelerated dental caries due to the cytotoxic effect on enamel.", value: "e" }
                ],
                correct: "e",
                explanation: "La quimioterapia no tiene un efecto directo sobre el esmalte dental maduro y formado. Todos los demás hallazgos (infecciones oportunistas, reacciones de la mucosa y problemas de sangrado por supresión de la médula ósea) son secuelas comunes de la quimioterapia."
            },
            {
                question: "A patient with a severe, documented allergy to nuts and penicillin experiences syncope, wheezing, and urticaria 3 minutes after a dental procedure. This reaction is initiated by antigen cross-linking of which antibody class on the surface of mast cells?",
                options: [
                    { text: "IgA", value: "a" },
                    { text: "IgD", value: "b" },
                    { text: "IgE", value: "c" },
                    { text: "IgG", value: "d" },
                    { text: "IgM", value: "e" }
                ],
                correct: "c",
                explanation: "La reacción descrita es una anafilaxia, la manifestación más severa de la Hipersensibilidad Tipo I (inmediata). Este tipo de reacción es mediada por la unión de antígenos a anticuerpos IgE en la superficie de mastocitos y basófilos, causando su degranulación."
            },
            {
                question: "A Type II hypersensitivity reaction, such as an ABO blood transfusion incompatibility, is immunologically distinct from a Type III reaction because the Type II reaction involves:",
                options: [
                    { text: "Antibody-antigen complexes depositing in tissues.", value: "a" },
                    { text: "IgE-mediated degranulation of basophils.", value: "b" },
                    { text: "Antibodies (IgG/IgM) directed against cell-surface antigens.", value: "c" },
                    { text: "A T-cell-mediated delayed inflammatory response.", value: "d" },
                    { text: "The release of leukotrienes and prostaglandins as primary mediators.", value: "e" }
                ],
                correct: "c",
                explanation: "La Hipersensibilidad Tipo II (Citotóxica) ocurre cuando anticuerpos IgG o IgM se dirigen contra antígenos que están FIJOS en la superficie de una célula (ej. un glóbulo rojo). La Tipo III es causada por complejos antígeno-anticuerpo SOLUBLES que se depositan en los tejidos."
            },
            {
                question: "A patient develops vasculitis, fever, and glomerulonephritis 10 days after receiving a vaccination. This systemic reaction, best characterized as serum sickness, is mediated by which pathogenic mechanism?",
                options: [
                    { text: "Deposition of circulating antigen-antibody complexes in tissues.", value: "a" },
                    { text: "Cytokine release from sensitized TH1 cells activating macrophages.", value: "b" },
                    { text: "Direct cytotoxic T-cell (CTL) killing of normal tissue.", value: "c" },
                    { text: "Antibody-mediated cellular dysfunction (agonistic/antagonistic).", value: "d" },
                    { text: "Histamine release from IgE-coated mast cells.", value: "e" }
                ],
                correct: "a",
                explanation: "La enfermedad del suero (Serum Sickness) es el ejemplo clásico de Hipersensibilidad Tipo III. Es una reacción sistémica causada por el depósito de inmunocomplejos (complejos antígeno-anticuerpo circulantes) en varios tejidos, como vasos sanguíneos (vasculitis) y riñones (glomerulonefritis)."
            },
            {
                question: "A dental assistant presents with an erythematous, vesicular rash on their hands 48 hours after wearing a new brand of gloves. This reaction, which is not associated with urticaria or respiratory distress, is most likely mediated by:",
                options: [
                    { text: "TH1 cells and activated macrophages.", value: "a" },
                    { text: "IgG antibodies against cell surface antigens.", value: "b" },
                    { text: "Immune complex deposition in dermal blood vessels.", value: "c" },
                    { text: "IgE-mediated degranulation.", value: "d" },
                    { text: "B-cell activation via TH2 cells.", value: "e" }
                ],
                correct: "a",
                explanation: "Una reacción retardada (48 horas) que se manifiesta como dermatitis de contacto es el ejemplo clásico de Hipersensibilidad Tipo IV (celular o retardada). Esta reacción no es mediada por anticuerpos, sino por células T (específicamente TH1) que liberan citoquinas y activan macrófagos."
            },
            {
                question: "During an immediate (Type I) hypersensitivity reaction, which of the following mediators is NOT considered a primary, pre-formed component released from mast cell granules, but is instead synthesized *after* cell activation?",
                options: [
                    { text: "Histamine", value: "a" },
                    { text: "Leukotrienes (SRS-A)", value: "b" },
                    { text: "Heparin", value: "c" },
                    { text: "Proteases (Tryptase)", value: "d" },
                    { text: "Eosinophil chemotactic factor (ECF-A)", value: "e" }
                ],
                correct: "b",
                explanation: "Los mediadores primarios (Histamina, Heparina, Proteasas, ECF-A) están pre-formados y almacenados en los gránulos del mastocito. Los Leucotrienos y Prostaglandinas son mediadores secundarios; se sintetizan a partir de la membrana celular (ácido araquidónico) SÓLO DESPUÉS de que la célula se activa."
            },
            {
                question: "Which of the following patient presentations is INCORRECTLY matched with its most probable iatrogenic or pathogenic cause?",
                options: [
                    { text: "A 7-year-old with developmental enamel hypoplasia and pulp obliteration; chronic renal failure.", value: "a" },
                    { text: "A 50-year-old with painful, ulcerative oral mucositis 7 days post-infusion; Methotrexate therapy.", value: "b" },
                    { text: "A 60-year-old with asymptomatic, exposed bone in a 10-week-old extraction site; Alendronate therapy.", value: "c" },
                    { text: "A 45-year-old with generalized gingival hyperplasia; Cyclosporine therapy.", value: "d" },
                    { text: "A 55-year-old with a positive tuberculin skin test (PPD); IgE-mediated degranulation.", value: "e" }
                ],
                correct: "e",
                explanation: "La prueba de tuberculina (PPD) es el ejemplo por excelencia de una Hipersensibilidad Tipo IV (retardada, mediada por células T). La degranulación mediada por IgE corresponde a la Hipersensibilidad Tipo I (inmediata/alergias). Esta es la única asociación incorrecta."
            }
        ];


        // --- Variables Globales ---
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length).fill(null);
        let score = 0;

        // --- Referencias al DOM ---
        const quizContainer = document.querySelector('.quiz-container');
        const header = document.querySelector('header');
        const progressText = document.getElementById('progressText');
        const quizBody = document.getElementById('quizBody');
        const nextBtn = document.getElementById('nextBtn');
        const resultsPage = document.getElementById('resultsPage');
        const quizFooter = document.querySelector('.quiz-footer');

        // --- Función para Cargar la Pregunta ---
        function loadQuestion(index) {
            // Limpia el contenido anterior
            quizBody.innerHTML = '';
            
            const questionData = quizData[index];

            // Crea el título de la pregunta
            const questionTitle = document.createElement('p');
            questionTitle.className = 'question-title';
            questionTitle.textContent = questionData.question;
            quizBody.appendChild(questionTitle);

            // Crea el contenedor de opciones
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';
            
            // Crea las opciones (radio buttons)
            questionData.options.forEach(option => {
                const label = document.createElement('label');
                
                const radio = document.createElement('input');
                radio.type = 'radio';
                radio.name = 'q'; // Todas las opciones de una pregunta tienen el mismo nombre
                radio.value = option.value;
                
                // Vuelve a seleccionar la respuesta si el usuario retrocediera (si implementáramos "back")
                if (userAnswers[index] === option.value) {
                    radio.checked = true;
                }
                
                const span = document.createElement('span');
                span.textContent = option.text;
                
                label.appendChild(radio);
                label.appendChild(span);
                optionsDiv.appendChild(label);
            });

            quizBody.appendChild(optionsDiv);
            
            // Actualiza el texto de progreso
            progressText.textContent = `Pregunta ${index + 1} de ${quizData.length}`;

            // Cambia el texto del botón si es la última pregunta
            if (index === quizData.length - 1) {
                nextBtn.textContent = 'Ver Resultados';
            } else {
                nextBtn.textContent = 'Siguiente';
            }
        }

        // --- Función para el Botón "Siguiente" ---
        function handleNextButton() {
            // 1. Validar si se seleccionó una respuesta
            const selectedOption = document.querySelector('input[name="q"]:checked');
            if (!selectedOption) {
                alert('Por favor, selecciona una respuesta antes de continuar.');
                return; // Detiene la función
            }

            // 2. Guardar la respuesta
            userAnswers[currentQuestionIndex] = selectedOption.value;

            // 3. Avanzar a la siguiente pregunta o mostrar resultados
            currentQuestionIndex++;

            if (currentQuestionIndex < quizData.length) {
                // Si hay más preguntas
                loadQuestion(currentQuestionIndex);
            } else {
                // Si se terminaron las preguntas
                showResults();
            }
        }

        // --- Función para Mostrar Resultados ---
        function showResults() {
            // 1. Ocultar el cuerpo del quiz y el botón
            quizBody.classList.add('hidden');
            quizFooter.classList.add('hidden');
            header.classList.add('hidden'); // Oculta también el header original

            // 2. Calcular la puntuación
            score = 0;
            let resultsHTML = ''; // String para construir el HTML de resultados

            quizData.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.correct;
                
                if (isCorrect) {
                    score++;
                }

                // Encontrar el texto de la opción seleccionada y la correcta
                const userAnswerText = question.options.find(opt => opt.value === userAnswer)?.text || "No respondida";
                const correctAnswerText = question.options.find(opt => opt.value === question.correct).text;

                // Construir el HTML para este item de resultado
                resultsHTML += `
                    <div class="result-item ${isCorrect ? 'correct' : 'incorrect'}">
                        <h3>Pregunta ${index + 1}: ${isCorrect ? 'Correcta' : 'Incorrecta'}</h3>
                        <p class="question-title">${question.question}</p>
                        <p><strong>Tu respuesta:</strong> ${userAnswerText}</p>
                        ${!isCorrect ? `<p class="answer-key"><strong>Respuesta correcta:</strong> ${correctAnswerText}</p>` : ''}
                        <div class="explanation">
                            <strong>Explicación:</strong> ${question.explanation}
                        </div>
                    </div>
                `;
            });

            // 3. Preparar el HTML final de resultados (con el resumen de puntuación)
            const finalResultsHTML = `
                <div class="score-summary">
                    <h1>Resultados Finales</h1>
                    <h2>${score} / ${quizData.length}</h2>
                </div>
                ${resultsHTML}
            `;

            // 4. Mostrar los resultados
            resultsPage.innerHTML = finalResultsHTML;
            resultsPage.classList.remove('hidden');

            // Mueve la vista al inicio de los resultados
            quizContainer.scrollIntoView({ behavior: 'smooth' });
        }


        // --- Event Listeners ---
        
        // Carga la primera pregunta cuando la página esté lista
        document.addEventListener('DOMContentLoaded', () => {
            loadQuestion(0);
        });

        // Asigna la función al botón "Siguiente"
        nextBtn.addEventListener('click', handleNextButton);

    </script>

</body>
</html>
